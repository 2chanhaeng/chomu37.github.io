---
layout: post
title: í¬ìŠ¤ì½”xì½”ë”©ì˜¨ ì›¹ í’€ìŠ¤íƒ ê³¼ì • 7ê¸° 11ì£¼ì°¨ ê¸ˆìš”ì¼ íšŒê³ 
description: >
  í¬ìŠ¤ì½” ì½”ë”©ì˜¨ ì›¹ í’€ìŠ¤íƒ ê³¼ì • 7ê¸° 11ì£¼ì°¨ ê¸ˆìš”ì¼ íšŒê³ 
tags: 
---
# [í¬ìŠ¤ì½”xì½”ë”©ì˜¨] ì›¹ í’€ìŠ¤íƒ ê³¼ì • 7ê¸° 11ì£¼ì°¨ ê¸ˆìš”ì¼ íšŒê³ 

- [\[í¬ìŠ¤ì½”xì½”ë”©ì˜¨\] ì›¹ í’€ìŠ¤íƒ ê³¼ì • 7ê¸° 11ì£¼ì°¨ ê¸ˆìš”ì¼ íšŒê³ ](#í¬ìŠ¤ì½”xì½”ë”©ì˜¨-ì›¹-í’€ìŠ¤íƒ-ê³¼ì •-7ê¸°-11ì£¼ì°¨-ê¸ˆìš”ì¼-íšŒê³ )
  - [nest.js](#nestjs)
  - [íŒ€ì› ë¶„ì˜ íƒˆì£¼](#íŒ€ì›-ë¶„ì˜-íƒˆì£¼)
  - [Prisma](#prisma)
  - [DTO](#dto)
  - [ì†Œì¼“](#ì†Œì¼“)

## nest.js

ì§€ë‚œ ì£¼ë§ë™ì•ˆ ì—´ì‹¬íˆ nest.js ì— ëŒ€í•´ ê³µë¶€ë¥¼ í–ˆë‹¤.  
nest ì˜ íŠ¹ì§• ì¤‘ í•˜ë‚˜ë¼ë©´ CLIê°€ ìˆë‹¤ëŠ” ê²ƒì´ì—ˆë‹¤.  
CLIë¥¼ í†µí•´ nest í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ê³ , ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤, ëª¨ë“ˆ ë“±ì„ ìƒì„±í•  ìˆ˜ ìˆì—ˆë‹¤.  
ì´ë¯¸ ì •ì˜ë˜ì–´ ìˆëŠ” ë°ì½”ë ˆì´í„°ë¥¼ í†µí•´ ê°„ë‹¨í•˜ê²Œ ë¼ìš°íŒ…ì„ ì •ì˜í•˜ëŠ” ë“± ì†ì‰½ê²Œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì •ì˜í•  ìˆ˜ ìˆì—ˆë‹¤.  
ë˜ DTO(Data Transfer Object)ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ê²€ì¦í•˜ê³  ë³€í™˜í•˜ê¸°ë„ í¸ë¦¬í–ˆë‹¤.  
ë‹¤ì–‘í•œ ê¸°ëŠ¥ì´ êµ¬í˜„ë˜ì–´ ìˆëŠ” ê²ƒì„ ë³´ë©°, ì´ë²ˆ í”„ë¡œì íŠ¸ëŠ” ì •ë§ ì¬ë°Œê²Œ ì§„í–‰ë  ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤.  
í•˜ì§€ë§Œ ì •ë§ ì˜ˆìƒì¹˜ ëª»í•œ ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤...  

## íŒ€ì› ë¶„ì˜ íƒˆì£¼

íŒ€ì› ë¶„ í•œ ë¶„ì´ ëŠ¦ê²Œê¹Œì§€ ì˜¤ì§ˆ ì•Šìœ¼ì…¨ë‹¤.  
ê·¸ëƒ¥ ê°œì¸ì ì¸ ì‚¬ì •ì´ ìˆë‚˜ë³´ë‹¤ ì‹¶ì—ˆëŠ”ë°, ê°•ì‚¬ë‹˜ê»˜ì„œ ì²­ì²œë²½ë ¥ê³¼ ê°™ì€ ì†Œì‹ì„ ì „í•´ì£¼ì…¨ë‹¤.  
íŒ€ì› ë¶„ì´ íƒˆì£¼í•˜ì…¨ë‹¤ëŠ” ì†Œì‹ì´ì—ˆë‹¤...  

ğŸ¥²

ë„ˆë¬´ ë‹¹í™©ìŠ¤ëŸ¬ì› ë‹¤.  
ì •í™©ì€ ë“£ì§€ ëª»í–ˆì§€ë§Œ, ì•„ë§ˆ ì·¨ì—…ì„ í•´ì„œ ì¡°ê¸° ì¡¸ì—…(?)ì„ í•˜ì‹  ê²ƒ ê°™ì•˜ë‹¤.  
ì•ˆ ê·¸ë˜ë„ ë‹¤ë¥¸ íŒ€ì€ ëª¨ë‘ 4ëª…ì´ê³  ìš°ë¦¬ë§Œ 3ëª…ì´ë¼ëŠ” ì ì€ íŒ€ì› ìˆ˜ë¡œ ì‹œì‘í–ˆëŠ”ë°, ê·¸ë§ˆì €ë„ í•œ ë¶„ì´ ë‚˜ê°€ì‹œë‹¤ë‹ˆ...  
ê·¸ ë¶„ì—ê²ŒëŠ” ì •ë§ ì˜ ëœ ì¼ì´ì—ˆì§€ë§Œ, ë‚¨ì€ ìš°ë¦¬ 2ëª…ì€ ë‹¹í™©ìŠ¤ëŸ¬ì› ë‹¤. ğŸ˜­  
í•˜ì§€ë§Œ ë‹¹í™©í•´í•  ì‹œê°„ë„ ì—†ì—ˆë‹¤.  
ì´ì   2ëª… ë°–ì— ì—†ê¸° ë•Œë¬¸ì´ì—ˆë‹¤.  

## Prisma

nestì—ì„œ Prisma ORM ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ Prisma ì„œë¹„ìŠ¤ê°€ í•„ìš”í–ˆë‹¤.
```typescript
import { INestApplication, Injectable, OnModuleInit } from "@nestjs/common";
import { PrismaClient } from "@prisma/client";

@Injectable()
export class PrismaService extends PrismaClient implements OnModuleInit {
  async onModuleInit() {
    await this.$connect();
  }

  async enableShutdownHooks(app: INestApplication) {
    this.$on("beforeExit", async () => {
      await app.close();
    });
  }
}
```
ì´í›„ DBê°€ í•„ìš”í•œ ëª¨ë“ˆì—ì„œ PrismaServiceë¥¼ ì£¼ì…ë°›ì•„ ì‚¬ìš©í•  ìˆ˜ ìˆì—ˆë‹¤.

## DTO

DTO(Data Transfer Object)ëŠ” ë°ì´í„°ë¥¼ ê²€ì¦í•˜ê³  ë³€í™˜í•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤.  
DTOë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë¨¼ì € `class-validator` ì™€ `class-transformer` ë¥¼ ì„¤ì¹˜í•´ì•¼ í•œë‹¤.  
ì´í›„ DTOë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤.
```typescript
import { IsString } from "class-validator";

export class CreateUserDto {
  @IsString()
  username: string;

  @IsString()
  password: string;
}
```
ë˜í•œ ì•±ì— ì „ì—­ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ `ValidationPipe` ë¥¼ ì„¤ì •í•´ì•¼ í•œë‹¤.
```typescript
import { ValidationPipe } from "@nestjs/common";
...
async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  app.useGlobalPipes(new ValidationPipe({
    whitelist: true, // DTOì— ì •ì˜ë˜ì§€ ì•Šì€ ì†ì„±ì´ ë“¤ì–´ì˜¤ë©´ ë¬´ì‹œ
    forbidNonWhitelisted: true, // DTOì— ì •ì˜ë˜ì§€ ì•Šì€ ì†ì„±ì´ ë“¤ì–´ì˜¤ë©´ ìš”ì²­ì„ ë§‰ìŒ
    transform: true, // ìš”ì²­ ë°ì´í„°ë¥¼ DTO íƒ€ì…ìœ¼ë¡œ ë³€í™˜
  }));
...
```
ì´ë ‡ê²Œ ì‘ì„±í•˜ë©´ ìš”ì²­ ë°ì´í„°ë¥¼ ê²€ì¦í•˜ê³ , DTO íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë°”ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í–ˆë‹¤.

## ì†Œì¼“

ë¨¼ì € nestì—ì„œ ì†Œì¼“ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„  gatewayë¥¼ ì •ì˜í•´ì•¼ í•œë‹¤.
```typescript
@WebSocketGateway( // gateway ë°ì½”ë ˆì´í„°
  81, // gatewayê°€ ì‚¬ìš©í•  í¬íŠ¸
  { transports: ["websocket"] }, // ì‚¬ìš©í•  í”„ë¡œí† ì½œ
)
export class ChatsGateway
  implements OnGatewayConnection, // í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ë˜ì—ˆì„ ë•Œ
    OnGatewayDisconnect, // í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ì´ ëŠê²¼ì„ ë•Œ
    OnGatewayInit // gatewayê°€ ì´ˆê¸°í™”ë˜ì—ˆì„ ë•Œ
{
  rooms: Map<string, RoomDto> = new Map(); // ì†Œì¼“ ë°© ëª©ë¡

  @WebSocketServer()
  server: Server;

  afterInit(server: Server) {
    // gatewayê°€ ì´ˆê¸°í™”ë˜ì—ˆì„ ë•Œ ì‹¤í–‰
  }

  handleConnection(client: Socket) {
    // í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ë˜ì—ˆì„ ë•Œ ì‹¤í–‰
  }

  handleDisconnect(client: Socket) {
    // í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ì´ ëŠê²¼ì„ ë•Œ ì‹¤í–‰
  }

  @SubscribeMessage("<ì´ë²¤íŠ¸ ì´ë¦„>") // í´ë¼ì´ì–¸íŠ¸ê°€ <ì´ë²¤íŠ¸ ì´ë¦„> ì´ë²¤íŠ¸ë¥¼ ë³´ëƒˆì„ ë•Œ ì‹¤í–‰
  handleCreate(
    @MessageBody("<ë©”ì„¸ì§€ ì†ì„±>") attr: MessageAttr, // í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚¸ ë°ì´í„° ì¤‘ <ë©”ì„¸ì§€ ì†ì„±> ì†ì„±
    @MessageBody() message: MessageDto, // í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚¸ ë°ì´í„°ë¥¼ <MessageDto> íƒ€ì…ìœ¼ë¡œ ë³€í™˜
    @ConnectedSocket() client: Socket, // í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“
  ) {
    const id = this.rooms.size + 1; // ë°© ID
    client.join(id); // í´ë¼ì´ì–¸íŠ¸ë¥¼ <id> ë°©ì— ì…ì¥ì‹œí‚´
    client.emit("<ì´ë²¤íŠ¸ ì´ë¦„>", message); // í´ë¼ì´ì–¸íŠ¸ì—ê²Œ <ì´ë²¤íŠ¸ ì´ë¦„> ì´ë²¤íŠ¸ë¥¼ ë³´ëƒ„
    client.to(message.roomId).emit("<ì´ë²¤íŠ¸ ì´ë¦„>", message); // <id> ë°©ì— <ì´ë²¤íŠ¸ ì´ë¦„> ì´ë²¤íŠ¸ë¥¼ ë³´ëƒ„
    return id; // í´ë¼ì´ì–¸íŠ¸ì—ê²Œ <id>ë¥¼ ë°˜í™˜
  }
}
```